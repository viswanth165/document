{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Parameters": {
        "VpcId": {
            "Type": "AWS::EC2::VPC::Id",
            "Description": "Enter the vpc ID"
        },
        "subneteks": {
            "Type": "List<AWS::EC2::Subnet::Id>",
            "Description": "Select the VPC under the selected VPC.P"
        },
        "Name": {
            "Type": "String",
            "Description": "Enter the Name"
        },
        "Owner": {
            "Type": "String",
            "Description": "Enter the Ownerr"
        },
        "Project": {
            "Type": "String",
            "Description": "Enter the Project"
        },
        "Application": {
            "Type": "String",
            "Description": "Enter the Application"
        },
        "Environment": {
            "Type": "String",
            "Description": "Enter the Environment"
        },
        "SecondaryOwner": {
            "Type": "String",
            "Description": "Enter the SecondaryOwner"
        },
        "SecretManagerName": {
            "Type": "String",
            "Description": "Enter the SecretManager"
        },
        "EKSsgProtocol": {
            "Type": "String",
            "Description": "Enter the EKS security group protocol to allow"
        },
        "EKSsgFromport": {
            "Type": "Number",
            "Description": "Enter the EKS security group fromport to allow"
        },
        "EKSsgToport": {
            "Type": "Number",
            "Description": "Enter the EKS security group toport to allow"
        },
        "EKSsgCIDR": {
            "Type": "String",
            "Description": "Enter the EKS security group cidr range to allow"
        },
        "EKSversion": {
            "Type": "String",
            "Description": "Enter the EKS version"
        },
        "EndpointPublicAccess": {
            "Type": "String",
            "AllowedValues": [
                "true",
                "false"
            ],
            "Default": "false",
            "Description": "Select the cluster to be public"
        },
        "EndpointPrivateAccess": {
            "Type": "String",
            "AllowedValues": [
                "true",
                "false"
            ],
            "Default": "true",
            "Description": "Select the cluster to be private"
        },
        "ForgateNamespace": {
            "Type": "String",
            "Description": "Enter the forgate selector name space"
        },
        "DBsgFromport": {
            "Type": "Number",
            "Description": "Enter the DB security group fromport"
        },
        "DBsgToport": {
            "Type": "Number",
            "Description": "Enter the DB security group toport"
        },
        "DBsgProtocol": {
            "Type": "String",
            "Description": "Enter the DB security group protocol"
        },
        "DBsgCIDR": {
            "Type": "String",
            "Description": "Enter the DB security group cidr range"
        },
        "DBAllocatedStorage": {
            "Type": "Number",
            "Description": "Enter the AllocatedStorage"
        },
        "DBInstanceClass": {
            "Type": "String",
            "Description": "Enter the DB instance class"
        },
        "DBEngine": {
            "Type": "String",
            "Description": "Enter the DB engine"
        },
        "DBEngineVersion": {
            "Type": "String",
            "Description": "Enter the DB engine version"
        },
        "DBMasterUsername": {
            "Type": "String",
            "Description": "Enter the DB username"
        },
        "DBSubnetGroupName": {
            "Type": "String",
            "Description": "Enter the Subnetgroup name"
        },
        "DBKmsKeyId": {
            "Type": "String",
            "Description": "Enter the KMS key id"
        },
        "DBBackupRetentionPeriod": {
            "Type": "Number",
            "Description": "Enter the backup retention period"
        }
    },
    "Metadata": {
        "AWS::CloudFormation::Designer": {
            "da3dda13-6525-4ba2-924a-d234f3b30f23": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 240,
                    "y": 480
                },
                "z": 1,
                "embeds": []
            },
            "8781427f-b8bf-450c-8599-e5dd1f0a075e": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 90,
                    "y": 480
                },
                "z": 1,
                "embeds": []
            },
            "6d973b60-12a0-4f91-a14e-ca9a92e718b3": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": -100,
                    "y": 480
                },
                "z": 1,
                "embeds": []
            },
            "452dd6c1-e667-4127-9b56-1a72f4562630": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 240,
                    "y": 270
                },
                "z": 1,
                "embeds": []
            },
            "0966724c-5ed8-46a9-b6c5-be3a6c575184": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 510,
                    "y": 480
                },
                "z": 1,
                "embeds": []
            },
            "715d3048-300d-4401-a24a-d3cbd70781db": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 690,
                    "y": 420
                },
                "z": 1,
                "embeds": []
            },
            "c01ef687-0d66-46e1-9d16-a5fa518b8487": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 750,
                    "y": 540
                },
                "z": 1,
                "embeds": []
            },
            "12620a76-4479-49f5-802f-62c8787f5206": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 510,
                    "y": 330
                },
                "z": 1,
                "embeds": []
            },
            "c4a1a4bc-856d-4b44-8882-538225f4bb76": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 240,
                    "y": 660
                },
                "z": 0,
                "embeds": []
            }
        }
    },
    "Resources": {
        "EKS": {
            "Type": "AWS::EKS::Cluster",
            "Properties": {
                "Name": {
                    "Fn::Join": [
                        "",
                        [
                            {
                                "Ref": "Name"
                            },
                            "-eks"
                        ]
                    ]
                },
                "Version": {
                    "Ref": "EKSversion"
                },
                "RoleArn": {
                    "Fn::GetAtt": [
                        "demo",
                        "Arn"
                    ]
                },
                "ResourcesVpcConfig": {
                    "SecurityGroupIds": [
                        {
                            "Ref": "sgeks"
                        }
                    ],
                    "SubnetIds": {
                        "Ref": "subneteks"
                    },
                    "EndpointPublicAccess": {
                        "Ref": "EndpointPublicAccess"
                    },
                    "EndpointPrivateAccess": {
                        "Ref": "EndpointPrivateAccess"
                    }
                },
                "Tags": [
                    {
                        "Key": "Owner",
                        "Value": {
                            "Ref": "Owner"
                        }
                    },
                    {
                        "Key": "Project",
                        "Value": {
                            "Ref": "Project"
                        }
                    },
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "",
                                [
                                    {
                                        "Ref": "Name"
                                    },
                                    "-eks"
                                ]
                            ]
                        }
                    },
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "Application"
                        }
                    },
                    {
                        "Key": "Environment",
                        "Value": {
                            "Ref": "Environment"
                        }
                    },
                    {
                        "Key": "SecondaryOwner",
                        "Value": {
                            "Ref": "SecondaryOwner"
                        }
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "da3dda13-6525-4ba2-924a-d234f3b30f23"
                }
            }
        },
        "demo": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "RoleName": {
                    "Fn::Join": [
                        "",
                        [
                            {
                                "Ref": "Name"
                            },
                            "-eks-role"
                        ]
                    ]
                },
                "AssumeRolePolicyDocument": {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Principal": {
                                "Service": [
                                    "ec2.amazonaws.com"
                                ]
                            },
                            "Action": [
                                "sts:AssumeRole"
                            ]
                        },
                        {
                            "Effect": "Allow",
                            "Principal": {
                                "Service": [
                                    "eks.amazonaws.com",
                                    "eks-fargate-pods.amazonaws.com",
                                    "ecs-tasks.amazonaws.com"
                                ]
                            },
                            "Action": [
                                "sts:AssumeRole"
                            ]
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Owner",
                        "Value": {
                            "Ref": "Owner"
                        }
                    },
                    {
                        "Key": "Project",
                        "Value": {
                            "Ref": "Project"
                        }
                    },
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "",
                                [
                                    {
                                        "Ref": "Name"
                                    },
                                    "-eks-role"
                                ]
                            ]
                        }
                    },
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "Application"
                        }
                    },
                    {
                        "Key": "Environment",
                        "Value": {
                            "Ref": "Environment"
                        }
                    },
                    {
                        "Key": "SecondaryOwner",
                        "Value": {
                            "Ref": "SecondaryOwner"
                        }
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "8781427f-b8bf-450c-8599-e5dd1f0a075e"
                }
            }
        },
        "policy": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyName": {
                    "Fn::Join": [
                        "",
                        [
                            {
                                "Ref": "Name"
                            },
                            "-eks-restricted-policy"
                        ]
                    ]
                },
                "PolicyDocument": {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "ec2:DescribeInstances",
                                "ec2:DescribeSnapshots",
                                "elasticloadbalancing:DescribeLoadBalancerPolicies",
                                "elasticloadbalancing:DeleteLoadBalancerListeners",
                                "elasticloadbalancing:RegisterInstancesWithLoadBalancer",
                                "elasticloadbalancing:CreateLoadBalancerListeners",
                                "elasticloadbalancing:CreateLoadBalancer",
                                "elasticloadbalancing:ModifyTargetGroup",
                                "route53:AssociateVPCWithHostedZone",
                                "ec2:DescribeVolumes",
                                "ec2:DescribeAccountAttributes",
                                "logs:CreateLogGroup",
                                "iam:ListAttachedRolePolicies",
                                "ecr:BatchCheckLayerAvailability",
                                "ec2:DescribeNetworkInterfaces",
                                "ec2:DescribeDhcpOptions",
                                "elasticloadbalancing:ModifyLoadBalancerAttributes",
                                "ecr:GetDownloadUrlForLayer",
                                "ec2:DetachVolume",
                                "elasticloadbalancing:DescribeTargetGroups",
                                "ec2:DescribeAvailabilityZones",
                                "elasticloadbalancing:DescribeTargetGroupAttributes",
                                "elasticloadbalancing:DetachLoadBalancerFromSubnets",
                                "ec2:DescribeSubnets",
                                "elasticloadbalancing:DeleteLoadBalancer",
                                "elasticloadbalancing:CreateLoadBalancerPolicy",
                                "ecr:BatchGetImage",
                                "elasticloadbalancing:DeleteTargetGroup",
                                "elasticloadbalancing:SetLoadBalancerPoliciesOfListener",
                                "ecr:GetLifecyclePolicy",
                                "ec2:DeleteRoute",
                                "autoscaling:DescribeAutoScalingGroups",
                                "elasticloadbalancing:DeregisterTargets",
                                "elasticloadbalancing:SetLoadBalancerPoliciesForBackendServer",
                                "elasticloadbalancing:ConfigureHealthCheck",
                                "elasticloadbalancing:ModifyTargetGroupAttributes",
                                "elasticloadbalancing:AttachLoadBalancerToSubnets",
                                "eks:UpdateClusterVersion",
                                "ecr:GetRepositoryPolicy",
                                "elasticloadbalancing:DeleteListener",
                                "ec2:DescribeRouteTables",
                                "ec2:AuthorizeSecurityGroupIngress",
                                "elasticloadbalancing:RegisterTargets",
                                "ec2:CreateTags",
                                "ec2:DetachNetworkInterface",
                                "ecr:DescribeImageScanFindings",
                                "logs:PutLogEvents",
                                "ecr:DescribeRepositories",
                                "ecr:DescribeImages",
                                "ecr:ListTagsForResource",
                                "ec2:ModifyVolume",
                                "ecr:ListImages",
                                "logs:DescribeLogStreams",
                                "ec2:DeleteTags",
                                "elasticloadbalancing:DescribeLoadBalancerAttributes",
                                "ec2:DescribeTags",
                                "elasticloadbalancing:CreateTargetGroup",
                                "ec2:DeleteSecurityGroup",
                                "ecr:GetLifecyclePolicyPreview",
                                "ec2:CreateNetworkInterface",
                                "ec2:DescribeInternetGateways",
                                "ec2:DescribeSecurityGroups",
                                "ec2:CreateRoute",
                                "elasticloadbalancing:DescribeLoadBalancers",
                                "ec2:DeleteVolume",
                                "kms:DescribeKey",
                                "ecr:GetAuthorizationToken",
                                "ec2:AttachNetworkInterface",
                                "elasticloadbalancing:CreateListener",
                                "elasticloadbalancing:ApplySecurityGroupsToLoadBalancer",
                                "ec2:ModifyNetworkInterfaceAttribute",
                                "elasticloadbalancing:DescribeTargetHealth",
                                "ec2:AttachVolume",
                                "elasticloadbalancing:AddTags",
                                "ec2:CreateVolume",
                                "ec2:UnassignPrivateIpAddresses",
                                "ec2:ModifyInstanceAttribute",
                                "ec2:CreateSnapshot",
                                "logs:CreateLogStream",
                                "ec2:RevokeSecurityGroupIngress",
                                "ec2:DescribeInstanceTypes",
                                "ec2:CreateSecurityGroup",
                                "ec2:DescribeVolumesModifications",
                                "ec2:DescribeInstanceAttribute",
                                "elasticloadbalancing:DeregisterInstancesFromLoadBalancer",
                                "elasticloadbalancing:ModifyListener",
                                "ec2:DeleteNetworkInterface",
                                "ec2:AssignPrivateIpAddresses",
                                "ec2:DescribeVpcs",
                                "ec2:CreateNetworkInterfacePermission",
                                "autoscaling:UpdateAutoScalingGroup",
                                "ec2:DescribeAddresses",
                                "elasticloadbalancing:DescribeListeners",
                                "ec2:DescribeLaunchTemplateVersions",
                                "ec2:CreateLaunchTemplateVersion",
                                "ec2:CreateLaunchTemplate",
                                "ec2:DescribeLaunchTemplates",
                                "iam:PassRole",
                                "eks:CreateNodegroup",
                                "eks:DescribeCluster",
                                "eks:JoinNodeGroup"
                            ],
                            "Resource": "*",
                            "Condition": {
                                "StringEquals": {
                                    "aws:PrincipalTag/Owner": {
                                        "Ref": "Owner"
                                    },
                                    "aws:PrincipalTag/Project": {
                                        "Ref": "Project"
                                    },
                                    "aws:PrincipalTag/Application": {
                                        "Ref": "Application"
                                    },
                                    "aws:PrincipalTag/Environment": {
                                        "Ref": "Environment"
                                    },
                                    "aws:PrincipalTag/SecondaryOwner": {
                                        "Ref": "SecondaryOwner"
                                    }
                                }
                            }
                        }
                    ]
                },
                "Roles": [
                    {
                        "Ref": "demo"
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "6d973b60-12a0-4f91-a14e-ca9a92e718b3"
                }
            }
        },
        "sgeks": {
            "Type": "AWS::EC2::SecurityGroup",
            "Properties": {
                "GroupName": {
                    "Fn::Join": [
                        "",
                        [
                            {
                                "Ref": "Name"
                            },
                            "-eks-sg"
                        ]
                    ]
                },
                "Tags": [
                    {
                        "Key": "Owner",
                        "Value": {
                            "Ref": "Owner"
                        }
                    },
                    {
                        "Key": "Project",
                        "Value": {
                            "Ref": "Project"
                        }
                    },
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "",
                                [
                                    {
                                        "Ref": "Name"
                                    },
                                    "-eks-sg"
                                ]
                            ]
                        }
                    },
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "Application"
                        }
                    },
                    {
                        "Key": "Environment",
                        "Value": {
                            "Ref": "Environment"
                        }
                    },
                    {
                        "Key": "SecondaryOwner",
                        "Value": {
                            "Ref": "SecondaryOwner"
                        }
                    }
                ],
                "VpcId": {
                    "Ref": "VpcId"
                },
                "GroupDescription": {
                    "Fn::Join": [
                        "",
                        [
                            {
                                "Ref": "Name"
                            },
                            "-eks-sg"
                        ]
                    ]
                },
                "SecurityGroupIngress": [
                    {
                        "IpProtocol": "tcp",
                        "FromPort": 80,
                        "ToPort": 80,
                        "CidrIp": {
                            "Ref": "EKSsgCIDR"
                        }
                    },
                    {
                        "IpProtocol": {
                            "Ref": "EKSsgProtocol"
                        },
                        "FromPort": {
                            "Ref": "EKSsgFromport"
                        },
                        "ToPort": {
                            "Ref": "EKSsgToport"
                        },
                        "CidrIp": {
                            "Ref": "EKSsgCIDR"
                        }
                    },
                    {
                        "IpProtocol": "tcp",
                        "FromPort": 5432,
                        "ToPort": 5432,
                        "CidrIp": {
                            "Ref": "EKSsgCIDR"
                        }
                    },
                    {
                        "IpProtocol": "tcp",
                        "FromPort": 443,
                        "ToPort": 443,
                        "CidrIp": {
                            "Ref": "EKSsgCIDR"
                        }
                    },
                    {
                        "IpProtocol": "tcp",
                        "FromPort": 9080,
                        "ToPort": 9080,
                        "CidrIp": {
                            "Ref": "EKSsgCIDR"
                        }
                    },
                    {
                        "IpProtocol": "tcp",
                        "FromPort": 9090,
                        "ToPort": 9090,
                        "CidrIp": {
                            "Ref": "EKSsgCIDR"
                        }
                    },
                    {
                        "IpProtocol": "tcp",
                        "FromPort": 4444,
                        "ToPort": 4444,
                        "CidrIp": {
                            "Ref": "EKSsgCIDR"
                        }
                    },
                    {
                        "IpProtocol": "tcp",
                        "FromPort": 9651,
                        "ToPort": 9651,
                        "CidrIp": {
                            "Ref": "EKSsgCIDR"
                        }
                    }
                ],
                "SecurityGroupEgress": [
                    {
                        "IpProtocol": "-1",
                        "FromPort": 0,
                        "ToPort": 0,
                        "CidrIp": "0.0.0.0/0"
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "452dd6c1-e667-4127-9b56-1a72f4562630"
                }
            }
        },
        "RDSDBI2QFNJ": {
            "Type": "AWS::RDS::DBInstance",
            "Properties": {
                "DBInstanceIdentifier": {
                    "Fn::Join": [
                        "",
                        [
                            {
                                "Ref": "Name"
                            },
                            "rds"
                        ]
                    ]
                },
                "DBInstanceClass": {
                    "Ref": "DBInstanceClass"
                },
                "AllocatedStorage": {
                    "Ref": "DBAllocatedStorage"
                },
                "Engine": {
                    "Ref": "DBEngine"
                },
                "DBName": {
                    "Fn::Join": [
                        "",
                        [
                            {
                                "Ref": "Name"
                            },
                            "db"
                        ]
                    ]
                },
                "EngineVersion": {
                    "Ref": "DBEngineVersion"
                },
                "MasterUsername": {
                    "Ref": "DBMasterUsername"
                },
                "MasterUserPassword": {
                    "Fn::Join": [
                        "",
                        [
                            "{{resolve:secretsmanager:",
                            {
                                "Ref": "SecretManager"
                            },
                            ":SecretString:password}}"
                        ]
                    ]
                },
                "DBSubnetGroupName": {
                    "Ref": "DBSubnetGroupName"
                },
                "DBParameterGroupName": {
                    "Ref": "DBparametergroup"
                },
                "StorageEncrypted": true,
                "EnableCloudwatchLogsExports": [
                    "postgresql"
                ],
                "BackupRetentionPeriod": {
                    "Ref": "DBBackupRetentionPeriod"
                },
                "AutoMinorVersionUpgrade": false,
                "VPCSecurityGroups": [
                    {
                        "Ref": "BDSG"
                    }
                ],
                "KmsKeyId": {
                    "Ref": "DBKmsKeyId"
                },
                "Tags": [
                    {
                        "Key": "Owner",
                        "Value": {
                            "Ref": "Owner"
                        }
                    },
                    {
                        "Key": "Project",
                        "Value": {
                            "Ref": "Project"
                        }
                    },
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "",
                                [
                                    {
                                        "Ref": "Name"
                                    },
                                    "-db"
                                ]
                            ]
                        }
                    },
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "Application"
                        }
                    },
                    {
                        "Key": "Environment",
                        "Value": {
                            "Ref": "Environment"
                        }
                    },
                    {
                        "Key": "SecondaryOwner",
                        "Value": {
                            "Ref": "SecondaryOwner"
                        }
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "0966724c-5ed8-46a9-b6c5-be3a6c575184"
                }
            }
        },
        "BDSG": {
            "Type": "AWS::EC2::SecurityGroup",
            "Properties": {
                "GroupName": {
                    "Fn::Join": [
                        "",
                        [
                            {
                                "Ref": "Name"
                            },
                            "-db-sg"
                        ]
                    ]
                },
                "Tags": [
                    {
                        "Key": "Owner",
                        "Value": {
                            "Ref": "Owner"
                        }
                    },
                    {
                        "Key": "Project",
                        "Value": {
                            "Ref": "Project"
                        }
                    },
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "",
                                [
                                    {
                                        "Ref": "Name"
                                    },
                                    "-db-sg"
                                ]
                            ]
                        }
                    },
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "Application"
                        }
                    },
                    {
                        "Key": "Environment",
                        "Value": {
                            "Ref": "Environment"
                        }
                    },
                    {
                        "Key": "SecondaryOwner",
                        "Value": {
                            "Ref": "SecondaryOwner"
                        }
                    }
                ],
                "VpcId": {
                    "Ref": "VpcId"
                },
                "GroupDescription": {
                    "Fn::Join": [
                        "",
                        [
                            {
                                "Ref": "Name"
                            },
                            "-db-sg"
                        ]
                    ]
                },
                "SecurityGroupIngress": [
                    {
                        "IpProtocol": {
                            "Ref": "DBsgProtocol"
                        },
                        "FromPort": {
                            "Ref": "DBsgFromport"
                        },
                        "ToPort": {
                            "Ref": "DBsgToport"
                        },
                        "CidrIp": {
                            "Ref": "DBsgCIDR"
                        }
                    }
                ],
                "SecurityGroupEgress": [
                    {
                        "IpProtocol": "-1",
                        "FromPort": 0,
                        "ToPort": 0,
                        "CidrIp": "0.0.0.0/0"
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "715d3048-300d-4401-a24a-d3cbd70781db"
                }
            }
        },
        "DBparametergroup": {
            "Type": "AWS::RDS::DBParameterGroup",
            "Properties": {
                "DBParameterGroupName": {
                    "Fn::Join": [
                        "",
                        [
                            {
                                "Ref": "Name"
                            },
                            "-db-pg"
                        ]
                    ]
                },
                "Tags": [
                    {
                        "Key": "Owner",
                        "Value": {
                            "Ref": "Owner"
                        }
                    },
                    {
                        "Key": "Project",
                        "Value": {
                            "Ref": "Project"
                        }
                    },
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "",
                                [
                                    {
                                        "Ref": "Name"
                                    },
                                    "-db-pg"
                                ]
                            ]
                        }
                    },
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "Application"
                        }
                    },
                    {
                        "Key": "Environment",
                        "Value": {
                            "Ref": "Environment"
                        }
                    },
                    {
                        "Key": "SecondaryOwner",
                        "Value": {
                            "Ref": "SecondaryOwner"
                        }
                    }
                ],
                "Family": "postgres14",
                "Description": "db"
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "c01ef687-0d66-46e1-9d16-a5fa518b8487"
                }
            }
        },
        "SecretManager": {
            "Type": "AWS::SecretsManager::Secret",
            "Properties": {
                "Name": {
                    "Ref": "SecretManagerName"
                },
                "GenerateSecretString": {
                    "SecretStringTemplate": "{\"username\": \"{{username}}\"}",
                    "GenerateStringKey": "password",
                    "PasswordLength": 10,
                    "ExcludeCharacters": "/@\" "
                },
                "Tags": [
                    {
                        "Key": "Owner",
                        "Value": {
                            "Ref": "Owner"
                        }
                    },
                    {
                        "Key": "Project",
                        "Value": {
                            "Ref": "Project"
                        }
                    },
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "",
                                [
                                    {
                                        "Ref": "Name"
                                    },
                                    "-db-sm"
                                ]
                            ]
                        }
                    },
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "Application"
                        }
                    },
                    {
                        "Key": "Environment",
                        "Value": {
                            "Ref": "Environment"
                        }
                    },
                    {
                        "Key": "SecondaryOwner",
                        "Value": {
                            "Ref": "SecondaryOwner"
                        }
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "12620a76-4479-49f5-802f-62c8787f5206"
                }
            }
        },
        "EKSFPH5JZ": {
            "Type": "AWS::EKS::FargateProfile",
            "Properties": {
                "ClusterName": {
                    "Ref": "EKS"
                },
                "FargateProfileName": {
                    "Fn::Join": [
                        "",
                        [
                            {
                                "Ref": "Name"
                            },
                            "-forgate"
                        ]
                    ]
                },
                "PodExecutionRoleArn": {
                    "Fn::GetAtt": [
                        "demo",
                        "Arn"
                    ]
                },
                "Selectors": [
                    {
                        "Namespace": {
                            "Ref": "ForgateNamespace"
                        }
                    }
                ],
                "Tags": [
                    {
                        "Key": "Owner",
                        "Value": {
                            "Ref": "Owner"
                        }
                    },
                    {
                        "Key": "Project",
                        "Value": {
                            "Ref": "Project"
                        }
                    },
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "",
                                [
                                    {
                                        "Ref": "Name"
                                    },
                                    "-eks"
                                ]
                            ]
                        }
                    },
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "Application"
                        }
                    },
                    {
                        "Key": "Environment",
                        "Value": {
                            "Ref": "Environment"
                        }
                    },
                    {
                        "Key": "SecondaryOwner",
                        "Value": {
                            "Ref": "SecondaryOwner"
                        }
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "c4a1a4bc-856d-4b44-8882-538225f4bb76"
                }
            }
        }
    }
}